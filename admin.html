<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Админ — вход</title>
<link rel="stylesheet" href="assets/style.css">
</head>
<body>
<header class="top"><div class="logo">Админ-панель</div><nav><a href="/">Главная</a> · <a href="games.html">Репо</a></nav></header>
<main class="container">
<section class="content">
<h1>Вход</h1>
<p class="meta">Одна учётка (админ). Регистрация запрещена — <em>ты лох</em>.</p>


<div id="loginBox">
<label>Пароль (подсказка: admin123)</label>
<input id="pw" type="password" class="input" placeholder="Введите пароль">
<button id="loginBtn" class="btn">Войти</button>
</div>


<div id="adminUI" style="display:none">
<h2>Редактор списка игр</h2>
<p class="small">Изменения сохраняются локально (localStorage). Чтобы применить изменения в репозитории — экспортируйте JSON и сделайте PR.</p>
<textarea id="jsonArea" style="width:100%;height:220px;border-radius:10px;padding:8px"></textarea>
<div style="display:flex;gap:8px;margin-top:8px">
<button id="saveLocal" class="btn">Сохранить локально</button>
<button id="exportJson" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.06)">Экспорт JSON</button>
</div>
</div>
</section>
</main>
<footer class="foot">Админка — честно скажем, это только UI для локального редактирования.</footer>
<script>
// лол у меня пароль прям в коду
const PASSWORD = 'admin89';
const loginBtn = document.getElementById('loginBtn');
const pwEl = document.getElementById('pw');
const adminUI = document.getElementById('adminUI');
const jsonArea = document.getElementById('jsonArea');


const STORAGE_KEY = 'retro_site_games_v1';


loginBtn.addEventListener('click', ()=>{
if(pwEl.value === PASSWORD){ document.getElementById('loginBox').style.display='none'; adminUI.style.display='block'; loadData(); }
else alert('Неверный пароль. подсказка: admin + iq админа');
});


async function loadData(){
// пробуем загрузить /data/games.json сначала
try{
const r = await fetch('data/games.json');
if(r.ok){ const j = await r.json(); jsonArea.value = JSON.stringify(j, null, 2); return }
}catch(e){}
// fallback: localStorage
const raw = localStorage.getItem(STORAGE_KEY) || '[]';
try{ JSON.parse(raw); jsonArea.value = JSON.stringify(JSON.parse(raw), null, 2); }catch(e){ jsonArea.value='[]' }
}


document.getElementById('saveLocal').addEventListener('click', ()=>{
try{ const parsed = JSON.parse(jsonArea.value); localStorage.setItem(STORAGE_KEY, JSON.stringify(parsed)); alert('Сохранено в localStorage. Чтобы обновить репо — экспортируйте JSON и сделайте PR с data/games.json.'); }
catch(e){ alert('JSON некорректен') }
});


document.getElementById('exportJson').addEventListener('click', ()=>{
const blob = new Blob([jsonArea.value], {type:'application/json'});
const url = URL.createObjectURL(blob);
const a = document.createElement('a'); a.href = url; a.download = 'games.json'; a.click(); URL.revokeObjectURL(url);
});
</script>
</body>
</html>